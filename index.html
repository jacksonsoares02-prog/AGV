<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Título da página atualizado -->
    <title>AGV - Proteção Veicular</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos base para a fonte e fundo */
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .form-card { max-width: 500px; }
        
        /* Estilização para o efeito de RÓTULO FIXO NO TOPO (Floating Label Permanente) */
        .input-group { position: relative; padding-top: 18px; } /* Adiciona padding para o label fixo */
        
        /* O label agora está sempre fixo no topo e menor */
        .input-group .label {
            position: absolute;
            left: 12px;
            top: 2px; /* Posição ajustada para o topo, dentro do padding-top */
            font-size: 0.75rem; /* Tamanho menor, como o do foco anterior */
            color: #1d4ed8; /* Cor azul destacada, como se estivesse focado (Tailwind blue-700) */
            transition: all 0.2s ease;
            pointer-events: none;
            background-color: transparent; /* Remove o fundo branco para não cortar a borda */
            padding: 0 4px;
            font-weight: 600; /* Deixa o texto do rótulo em negrito leve para destaque */
            z-index: 10;
        }

        /* O input precisa de um padding maior para não sobrepor o rótulo */
        .input-group input {
            padding-top: 10px; /* Redefine o padding do input para acomodar o rótulo */
        }
        
        /* Adiciona um asterisco vermelho discreto nos labels dos campos obrigatórios */
        .input-group input[required] ~ .label::after {
            content: '*';
            color: #ef4444; /* Tailwind red-500 */
            margin-left: 4px;
        }

        /* Removido: O código que movia o label no focus/not(:placeholder-shown) foi removido
           pois o label deve estar sempre fixo no topo. */

        /* Estilos específicos para o botão de WhatsApp */
        .whatsapp-button {
            transition: background-color 0.3s ease, transform 0.1s ease;
        }
        .whatsapp-button:hover {
            background-color: #128c7e; /* Cor um pouco mais escura */
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Garante que o input de telefone só aceite dígitos e limite o tamanho */
        #telefone {
            appearance: none;
            -moz-appearance: textfield;
        }
        #telefone::-webkit-inner-spin-button, 
        #telefone::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }

        /* Estilo para o link de endereço no rodapé */
        .address-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body class="p-4 sm:p-8 flex flex-col items-center justify-center min-h-screen">

    <!-- Card Principal do Formulário -->
    <div class="form-card w-full mb-0 shadow-2xl rounded-xl overflow-hidden bg-white">
        
        <!-- CABEÇALHO AZUL: AGV - Proteção Veicular -->
        <header class="bg-blue-700 text-white p-6 sm:p-8 text-center">
            <!-- Placeholder para o Logo AGV. Substitua 'URL_DO_LOGO_AQUI' pela URL real do logo. -->
            <img src="URL_DO_LOGO_AQUI" 
                 onerror="this.onerror=null; this.src='https://placehold.co/200x50/ffffff/1d4ed8?text=LOGO+AGV'"
                 alt="Logo AGV Proteção Veicular" 
                 class="mx-auto h-12 sm:h-14 mb-3">
            <!-- Título da Empresa -->
            <h1 class="text-2xl sm:text-3xl font-bold">AGV - Proteção Veicular</h1>
        </header>

        <!-- Conteúdo do Formulário -->
        <div class="p-6 sm:p-8">
            <div class="flex items-center space-x-3 mb-6 border-b pb-4">
                <!-- Ícone de Escudo/Proteção -->
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7 text-blue-600">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
                <h2 class="text-xl sm:text-2xl font-semibold text-gray-800">Inicie Sua Cotação Rápida</h2>
            </div>
            
            <!-- TEXTO DE INSTRUÇÃO SIMPLIFICADO -->
            <p class="text-gray-600 mb-6">Preencha os dados abaixo para iniciar sua cotação rápida pelo WhatsApp.</p>

            <form id="cotacaoForm" class="space-y-6">
                
                <!-- Campo Nome (Obrigatório) -->
                <div class="input-group">
                    <input type="text" id="nome" name="nome" placeholder=" " required 
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition duration-150">
                    <label for="nome" class="label">Seu Nome Completo</label>
                </div>

                <!-- Campo Telefone (Obrigatório) -->
                <div class="input-group">
                    <input type="tel" id="telefone" name="telefone" placeholder=" " required maxlength="11"
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition duration-150">
                    <label for="telefone" class="label">Telefone / WhatsApp (Apenas números)</label>
                </div>

                <!-- Campo E-mail (OBRIGATÓRIO) -->
                <div class="input-group">
                    <input type="email" id="email" name="email" placeholder=" " required 
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition duration-150">
                    <label for="email" class="label">E-mail</label>
                </div>

                <!-- Campo Placa (OBRIGATÓRIO) -->
                <div class="input-group">
                    <input type="text" id="placa" name="placa" placeholder=" " required maxlength="7"
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition duration-150 uppercase">
                    <label for="placa" class="label">Placa do Veículo (Ex: ABC1234)</label>
                </div>

                <div class="flex flex-col sm:flex-row space-y-6 sm:space-y-0 sm:space-x-4">
                    <!-- Campo Marca (AGORA OBRIGATÓRIO) -->
                    <div class="input-group flex-1">
                        <input type="text" id="marca" name="marca" placeholder=" " required 
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition duration-150">
                        <label for="marca" class="label">Marca do Veículo</label>
                    </div>
                    <!-- Campo Modelo (OBRIGATÓRIO) -->
                    <div class="input-group flex-1">
                        <input type="text" id="modelo" name="modelo" placeholder=" " required
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition duration-150">
                        <label for="modelo" class="label">Modelo do Veículo</label>
                    </div>
                </div>

                <!-- Campo Ano (OBRIGATÓRIO) -->
                <div class="input-group">
                    <input type="number" id="ano" name="ano" placeholder=" " min="1900" max="2099" required
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition duration-150">
                    <label for="ano" class="label">Ano do Veículo</label>
                </div>

                <button type="submit" id="submitButton"
                        class="whatsapp-button w-full bg-green-500 text-white font-bold py-3 rounded-xl text-lg shadow-lg hover:bg-green-600 focus:outline-none focus:ring-4 focus:ring-green-300 transition duration-300 flex items-center justify-center space-x-2">
                    <!-- Ícone do WhatsApp usando SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12c0 1.95.553 3.766 1.503 5.312l-1.01 3.693 3.77-.996C6.72 20.472 9.24 21 12 21c5.523 0 10-4.477 10-10S17.523 2 12 2zm4.8 12.8c-.3-.15-.75-.23-1.08-.32-.33-.09-.57-.14-.8-.14-.24 0-.47 0-.7.09-.23.09-.5.22-.76.48-.26.26-.54.59-.66.72-.12.12-.24.25-.47.25-.23 0-.47-.09-.7-.22-.23-.09-.47-.19-.9-.38-.43-.19-.79-.47-1.11-.79-.32-.32-.59-.69-.76-1.02-.17-.33-.28-.7-.28-1.07 0-.37.1-.6.28-.79.17-.19.37-.32.48-.44.12-.12.24-.25.37-.47.12-.22.18-.47.25-.7.06-.23.09-.47 0-.7-.09-.23-.42-.51-.61-.75-.19-.24-.42-.48-.61-.6-.19-.12-.41-.22-.64-.22-.23 0-.46.06-.67.09-.21.03-.43.03-.64.03-.21 0-.44-.03-.67 0-.23.03-.46.09-.7.22-.24.12-.47.25-.7.47-.23.22-.45.48-.64.75-.19.27-.32.54-.42.82-.1.28-.15.58-.15.89 0 .31.06.6.18.91.12.3.29.6.47.88.19.28.41.56.64.82.23.26.47.51.7.75.24.24.47.48.7.67.23.19.48.37.76.54.28.17.59.32.91.44.32.12.67.19 1.02.19.37 0 .7-.09 1.04-.15.34-.06.66-.19.98-.32.32-.12.63-.28.92-.47.29-.19.55-.42.76-.66.21-.24.37-.51.47-.82.1-.31.15-.63.15-.96 0-.33-.03-.66-.1-.98z"/></svg>
                    <span>Iniciar Cotação Pelo WhatsApp</span>
                </button>
                <div id="messageBox" class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden"></div>
            </form>
        </div>
    </div>
    
    <!-- RODAPÉ AZUL (Novo Estilo) -->
    <div class="form-card w-full mt-0 mb-6 bg-blue-700 p-4 rounded-xl shadow-md">
        <!-- Detalhes do Corretor -->
        <div class="flex items-center space-x-4 mb-4 pb-4 border-b border-blue-500">
            <!-- Placeholder para a Foto do Corretor. Substitua 'URL_FOTO_CORRETOR_AQUI' pela URL real. -->
            <img src="URL_FOTO_CORRETOR_AQUI" 
                 onerror="this.onerror=null; this.src='https://placehold.co/80x80/cccccc/333333?text=FOTO';"
                 alt="Foto do Corretor Jackson Soares" 
                 class="w-16 h-16 rounded-full object-cover border-2 border-white flex-shrink-0">
            <div>
                <p class="font-bold text-white text-lg">Jackson Soares</p>
                <p class="text-sm text-blue-300">Corretor de Referência</p>
                <p class="text-xs text-blue-200">AGV Proteção Veicular</p>
            </div>
        </div>
        
        <!-- Bloco de Endereço Clicável para o Google Maps -->
        <a href="https://www.google.com/maps/search/?api=1&query=Rua+Monte+Camberela%2C+184+-+CEP%3A+08452-340+-+S%C3%A3o+Paulo%2FSP" 
           target="_blank" 
           rel="noopener noreferrer"
           class="flex items-start space-x-3 text-white hover:text-blue-300 address-link">
            <!-- Ícone de Localização (Agora Branco) -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-white mt-0.5 flex-shrink-0">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
            </svg>
            <p class="text-sm">
                Rua Monte Camberela, 184 - CEP: 08452-340 - São Paulo/SP
            </p>
        </a>
        
        <!-- Observação da Unidade -->
        <p class="text-sm text-blue-200 mt-2 ml-8">Unidade Itaim Paulista</p>
    </div>

    <script>
        // ATENÇÃO: Substitua 'URL_DO_LOGO_AQUI' e 'URL_FOTO_CORRETOR_AQUI' pelas URLs reais das imagens.
        // Se as URLs não forem substituídas, serão exibidos placeholders.
        
        // URL do Webhook do Make.com (confirmado)
        const MAKE_WEBHOOK_URL = 'https://hook.us2.make.com/m2lwthx8sswb54m88r6fg1m9jx8ky3n2'; 
        
        // Dados fixos do corretor e endereço (confirmados)
        const CORRETOR_NOME = 'Jackson Soares';
        // Endereço fixo do corretor, usado também na mensagem do WhatsApp
        const CORRETOR_ENDERECO = 'Rua Monte Camberela, 184 - CEP: 08452-340 - São Paulo/SP'; 
        
        // NOVO NÚMERO DE ATENDIMENTO: 11981087312, formatado com código do país 55 e DDD 11.
        const ATENDIMENTO_NUMBER = '5511981087312'; // Número de atendimento AGV

        document.getElementById('cotacaoForm').addEventListener('submit', function(event) {
            event.preventDefault();
            sendToWebhook();
        });

        // Limita o campo de telefone a apenas números (11 dígitos, incluindo DDD)
        document.getElementById('telefone').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/[^0-9]/g, '').substring(0, 11);
        });

        // Converte o campo de placa para maiúsculas e limita a 7 caracteres
        document.getElementById('placa').addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, '').substring(0, 7);
        });

        // Função para formatar a data para o horário de São Paulo (DD/MM/YYYY HH:mm:ss)
        function formatDateToSaoPaulo() {
            const date = new Date();
            const options = {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'America/Sao_Paulo',
                hour12: false 
            };
            
            const formatter = new Intl.DateTimeFormat('pt-BR', options);
            const parts = formatter.formatToParts(date);
            
            const day = parts.find(p => p.type === 'day').value;
            const month = parts.find(p => p.type === 'month').value;
            const year = parts.find(p => p.type === 'year').value;
            const hour = parts.find(p => p.type === 'hour').value;
            const minute = parts.find(p => p.type === 'minute').value;
            const second = parts.find(p => p.type === 'second').value;

            return `${day}/${month}/${year} ${hour}:${minute}:${second}`;
        }

        // Função para formatar o número de telefone para (XX) XXXXX-XXXX
        function formatPhoneNumber(phone) {
            const cleanPhone = phone.replace(/\D/g, '');

            if (cleanPhone.length === 11) {
                return `(${cleanPhone.substring(0, 2)}) ${cleanPhone.substring(2, 7)}-${cleanPhone.substring(7, 11)}`;
            }
            if (cleanPhone.length === 10) {
                return `(${cleanPhone.substring(0, 2)}) ${cleanPhone.substring(2, 6)}-${cleanPhone.substring(6, 10)}`;
            }
            
            return cleanPhone; 
        }

        async function sendToWebhook() {
            const form = document.getElementById('cotacaoForm');
            const nome = form.nome.value.trim();
            const email = form.email.value.trim();
            const placa = form.placa.value.trim();
            const marca = form.marca.value.trim();
            const modelo = form.modelo.value.trim();
            const ano = form.ano.value.trim();
            const corretor = CORRETOR_NOME; 

            const phoneClean = form.telefone.value.replace(/\D/g, '');
            const phoneFormatted = formatPhoneNumber(phoneClean);
            
            // Validação de telefone
            if (phoneClean.length < 10) {
                showMessage('Por favor, verifique o campo Telefone/WhatsApp. É necessário incluir o DDD e pelo menos 8 dígitos.', 'bg-red-100 border-red-400 text-red-700');
                return;
            }

            const placaFinal = placa.length >= 1 ? placa.slice(-1) : '';

            // Dados a serem enviados ao Make.com
            const data = {
                nome: nome,
                telefone: phoneClean, 
                email: email,
                placa: placa,
                dígitoFinal: placaFinal, 
                marca: marca,
                modelo: modelo,
                ano: ano,
                corretor: corretor, 
                data_hora_envio: formatDateToSaoPaulo() 
            };
            
            // 1. Enviar para o Webhook do Make.com (assíncrono)
            try {
                const response = await fetch(MAKE_WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    console.error('Erro ao enviar dados para o Make.com:', response.statusText);
                } else {
                    console.log('Dados enviados com sucesso ao Make.com');
                }
            } catch (error) {
                console.error('Erro de rede ao enviar para o Make.com:', error);
            }
            
            // 2. Criar e redirecionar para o link do WhatsApp (síncrono)
            
            // Mensagem formatada para o WhatsApp (usando \n para quebra de linha)
            const whatsappMessage = encodeURIComponent(
                `Olá! Meu nome é ${nome} e gostaria de iniciar a cotação da proteção veicular.\n\n` +
                `Detalhes do veículo:\n` +
                `Placa: ${placa} (Dígito Final: ${placaFinal})\n` +
                `Marca: ${marca || 'Não informado'}\n` +
                `Modelo: ${modelo}\n` +
                `Ano: ${ano}\n\n` +
                `Meu telefone/WhatsApp:\n${phoneFormatted}\n` + 
                `E-mail:\n${email}\n\n` + 
                `Corretor de Referência: ${corretor}\n` + 
                `Endereço de Referência:\n${CORRETOR_ENDERECO}` 
            );

            // Redireciona para o WhatsApp
            const whatsappLink = `https://wa.me/${ATENDIMENTO_NUMBER}?text=${whatsappMessage}`;
            
            window.location.href = whatsappLink;

            showMessage('Redirecionando para o WhatsApp...', 'bg-green-100 border-green-400 text-green-700');
        }

        function showMessage(text, className) {
            const msgBox = document.getElementById('messageBox');
            msgBox.textContent = text;
            msgBox.className = `mt-4 p-3 border rounded-lg ${className}`;
            msgBox.classList.remove('hidden');
            setTimeout(() => {
                // Esconde a mensagem depois de 3 segundos (exceto se for uma mensagem crítica de erro)
                if (className.includes('green') || className.includes('red')) {
                     msgBox.classList.add('hidden');
                }
            }, 3000);
        }
    </script>
</body>
</html>
